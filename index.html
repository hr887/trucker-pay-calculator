<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Truck Driver Pay Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .bg-pattern {
            background-image: radial-gradient(#dbeafe 1px, transparent 1px);
            background-size: 16px 16px;
        }
        .view { transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out; width: 100%; }
        .view-container { position: relative; min-height: 450px; }
        .view.hidden { opacity: 0; transform: scale(0.98); pointer-events: none; position: absolute; top: 0; left: 0; }
        .btn { transition: all 0.2s ease-in-out; border-radius: 0.5rem; padding-top: 0.875rem; padding-bottom: 0.875rem; font-weight: 600; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
        .btn-primary { background-color: #2c3e50; color: white; }
        .btn-primary:hover { background-color: #34495e; }
        .btn-action { background-color: #1abc9c; color: white; }
        .btn-action:hover { background-color: #1dd2af; }
        .progress-bar-bg { background-color: #e0e0e0; border-radius: 9999px; overflow: hidden; }
        .progress-bar-fill { background-color: #1abc9c; transition: width 0.5s ease-in-out; }
        .lang-btn { font-size: 0.875rem; font-weight: 500; padding: 0.5rem 1rem; border-radius: 0.375rem; transition: background-color 0.2s, color 0.2s; text-align: left; width: 100%; }
        .lang-btn.active { background-color: #1abc9c; color: white; }
    </style>
</head>
<body class="antialiased bg-pattern">

    <div class="min-h-screen w-full flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-md text-gray-800 relative">
            
            <header class="p-4 sm:p-6 flex justify-between items-center border-b border-gray-200">
                <div class="flex items-center space-x-3">
                    <button id="back-arrow" class="text-gray-400 hover:text-gray-700 transition-colors hidden">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                    </button>
                    <img src="https://i.postimg.cc/BvFFBrMk/image.png" alt="Company Logo" class="h-10 w-auto">
                </div>
                <div class="relative">
                    <button id="language-toggle-btn" class="text-sm font-semibold text-gray-500 hover:bg-gray-100 px-3 py-1 border border-gray-300 rounded-full transition-colors">
                        Language
                    </button>
                    <div id="language-dropdown" class="absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg p-1 z-20 hidden">
                        <button id="lang-en" onclick="setLanguage('en')" class="lang-btn">English</button>
                        <button id="lang-es" onclick="setLanguage('es')" class="lang-btn">Español</button>
                        <button id="lang-ru" onclick="setLanguage('ru')" class="lang-btn">&#1056;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;</button>
                        <button id="lang-uz" onclick="setLanguage('uz')" class="lang-btn">O'zbek</button>
                    </div>
                </div>
            </header>
            
            <div class="p-6 sm:p-8">
                <div class="text-center mb-6">
                     <p class="text-lg font-semibold text-gray-700" data-key="appTitle">Truck Driver Pay Calculator</p>
                </div>

                <div id="progress-container" class="my-6">
                    <p id="progress-text" class="text-sm font-semibold text-center text-gray-500 mb-2" data-key="progressText">Step 1 of 3: Driver Type</p>
                    <div class="progress-bar-bg h-2 w-full">
                        <div id="progress-bar" class="progress-bar-fill h-2" style="width: 33%;"></div>
                    </div>
                </div>
                
                <div class="view-container">
                       <div id="view-question1" class="view">
                           <div class="text-center mb-6 p-3 bg-teal-50 border border-teal-200 rounded-lg">
                               <p class="text-base font-bold text-teal-800" data-key="promoTitle">Earn up to $6000/week with us!</p>
                               <p class="text-sm text-teal-600" data-key="promoSubtitle">Find out your potential take-home pay below.</p>
                           </div>
                           <h2 class="text-xl font-bold text-center mb-4" data-key="question1Title">What type of driver are you?</h2>
                           <div class="space-y-4">
                               <button onclick="trackClickEvent('Selected Lease Operator'); selectDriverType('lease');" class="btn btn-primary w-full" data-key="leaseButton">Lease Operator</button>
                               <button onclick="trackClickEvent('Selected Company Driver'); selectDriverType('company');" class="btn btn-primary w-full" data-key="companyButton">Company Driver</button>
                               <button onclick="trackClickEvent('Selected Owner Operator'); selectDriverType('owner');" class="btn btn-primary w-full" data-key="ownerButton">Owner Operator</button>
                           </div>
                       </div>

                       <div id="view-question2" class="view hidden">
                           <h2 class="text-xl font-bold text-center mb-4" data-key="question2Title">How many miles can you drive in a week?</h2>
                           <div class="space-y-4">
                               <input type="number" id="miles-input" class="w-full text-center text-lg p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition">
                               <button onclick="trackClickEvent('Clicked Calculate'); submitMiles();" class="btn btn-action w-full" data-key="calculateButton">Calculate</button>
                           </div>
                       </div>

                       <div id="view-result" class="view hidden text-center">
                           <h2 class="text-xl font-semibold text-gray-600 mb-2" data-key="resultTitle">Your Potential Take Home Is</h2>
                           <p id="result-amount" class="text-5xl font-extrabold text-gray-900 mb-2">$0.00</p>
                           <div id="result-message" class="p-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-800 text-sm mb-4"></div>
                           <button onclick="trackClickEvent('Clicked See Calculation'); showCalculation();" class="text-sm text-indigo-600 hover:underline mb-4" data-key="seeCalculationLink">See how we calculated this</button>
                           <div class="space-y-3">
                               <button onclick="trackClickEvent('Clicked APPLY NOW'); showView('view-apply');" class="btn btn-action w-full text-lg" data-key="applyNowButton">APPLY NOW</button>
                               <button onclick="trackClickEvent('Clicked Share Estimate'); shareResult();" class="btn bg-gray-200 hover:bg-gray-300 text-gray-800 w-full flex items-center justify-center space-x-2">
                                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z"></path></svg>
                                   <span data-key="shareButton">Share Estimate</span>
                               </button>
                               <button onclick="trackClickEvent('Clicked New Calculation'); restart();" class="btn bg-gray-500 hover:bg-gray-600 text-white w-full" data-key="newCalculationButton">Start a New Calculation</button>
                           </div>
                           <div class="mt-8 pt-4 border-t border-gray-200">
                               <p class="text-lg font-semibold text-gray-700 mb-4" data-key="contactUs">Contact Us</p>
                               <div class="mb-4">
                                   <div class="flex justify-center items-center space-x-6">
                                       <a href="tel:+18474079858" onclick="trackClickEvent('Clicked Phone Icon');" class="text-gray-400 hover:text-green-600 transition-colors" title="Call Us">
                                           <svg class="w-7 h-7" fill="currentColor" viewBox="0 0 24 24"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg>
                                       </a>
                                       <a href="https://t.me/tomr_robins0n" target="_blank" rel="noopener noreferrer" onclick="trackClickEvent('Clicked Telegram Icon');" class="text-gray-400 hover:text-sky-600 transition-colors" title="Telegram">
                                           <img src="https://telegram.org/img/t_logo.png" alt="Telegram Logo" class="w-7 h-7">
                                       </a>
                                   </div>
                                   <a href="mailto:hr@raystarllc.com" onclick="trackClickEvent('Clicked Email Text');" class="block mt-3 text-gray-500 hover:text-indigo-600 transition-colors text-sm font-medium">hr@raystarllc.com</a>
                               </div>
                           </div>
                       </div>

                       <div id="view-apply" class="view hidden">
                           <h2 class="text-xl font-bold text-center mb-4" data-key="applyTitle">Apply Now</h2>
                           <form id="application-form" class="space-y-4">
                               <input name="fullName" type="text" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                               <input name="phone" type="tel" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                               <input name="email" type="email" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                               <button id="submit-form-button" type="submit" class="btn btn-action w-full" data-key="submitApplicationButton">Submit Application</button>
                           </form>
                       </div>
                       
                       <div id="view-thanks" class="view hidden text-center">
                           <h2 class="text-2xl font-bold text-green-600 mb-4" data-key="thanksTitle">Thank You!</h2>
                           <p class="text-gray-600" data-key="thanksSubtitle">Your application has been submitted. We will be in touch shortly.</p>
                           <button onclick="restart();" class="btn btn-primary w-full mt-6" data-key="startOverButton">Start Over</button>
                       </div>
                       
                       <div id="view-calculation" class="view hidden text-left">
                           <h2 class="text-xl font-bold text-center mb-4" data-key="breakdownTitle">Calculation Breakdown</h2>
                           <div id="calculation-details" class="space-y-4 text-sm text-gray-700"></div>
                       </div>
                </div>

                <div class="text-center mt-8 pt-4 border-t border-gray-200">
                    <p class="text-xs text-gray-400" data-key="copyright">&copy; 2025 Ray Star LLC. All Rights Reserved.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbylfdSVfvAph-Uhngaa43ZL-9E4hZW-bqYWjfa06-VJ7ifRyIjtJwNkTeNr2cRIFaC0Gg/exec';
        
        const translations = {
            en: {
                promoTitle: 'Earn up to $6000/week with us!', appTitle: 'Truck Driver Pay Calculator', progressText: 'Step {step} of 3: {page}', promoSubtitle: 'Find out your potential take-home pay below.', question1Title: 'What type of driver are you?', leaseButton: 'Lease Operator', companyButton: 'Company Driver', ownerButton: 'Owner Operator', question2Title: 'How many miles can you drive in a week?', milesPlaceholder: 'e.g., 2500', calculateButton: 'Calculate', resultTitle: 'Your Potential Take Home Is', resultMsgHigh: '&#127942; Outstanding result! You\'re in the top tier of earners.', resultMsgMid: '&#x2728; Excellent result! This is a strong, competitive income.', resultMsgLow: '&#x1F4C8; A great starting point with solid potential for growth.', seeCalculationLink: 'See how we calculated this', applyNowButton: 'APPLY NOW', shareButton: 'Share Estimate', newCalculationButton: 'Start a New Calculation', applyTitle: 'Apply Now', applySubtitle: 'You\'re one step away! Fill out your info below.', fullNamePlaceholder: 'Full name', phonePlaceholder: 'Phone number', emailPlaceholder: 'Email', privacyLink: 'Learn how we use your personal data', submitApplicationButton: 'Submit Application', thanksTitle: 'Thank You!', thanksSubtitle: 'Your application has been submitted. We will be in touch shortly.', startOverButton: 'Start Over', breakdownTitle: 'Calculation Breakdown', copyright: '&copy; 2025 Ray Star LLC. All Rights Reserved.', contactUs: 'Contact Us', calcGrossIncome: '1. Gross Income', calcMilesDriven: '{miles} miles', calcPerMile: '× ${rate}/mile', calcExpenses: '2. Estimated Expenses', calcFixedCosts: 'Fixed Costs:', calcVariableCosts: 'Variable Costs (for {miles} miles):', calcTotalExpenses: 'Total Estimated Expenses', calcTakeHome: '3. Potential Take-Home', calcIncome: 'Income', calcMinusExpenses: 'Expenses',
            },
            es: { /* ... Spanish ... */ },
            ru: { /* ... Russian ... */ },
            uz: { /* ... Uzbek ... */ }
        };
        
        const state = { driverType: null, miles: 0, takeHomePay: 0, lang: 'en' };
        
        const languageToggleBtn = document.getElementById('language-toggle-btn');
        const languageDropdown = document.getElementById('language-dropdown');
        const backArrow = document.getElementById('back-arrow');
        
        function setLanguage(lang) {
            languageDropdown.classList.add('hidden');
            if (!translations[lang]) return;
            state.lang = lang;
            
            ['en', 'es', 'ru', 'uz'].forEach(id => {
                document.getElementById(`lang-${id}`).classList.toggle('active', id === lang);
            });

            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.getAttribute('data-key');
                if (translations[lang][key]) el.innerHTML = translations[lang][key];
            });

            const milesInput = document.getElementById('miles-input');
            if(milesInput) milesInput.placeholder = translations[lang].milesPlaceholder || 'e.g., 2500';
            
            const formInputs = {'fullName': 'fullNamePlaceholder', 'phone': 'phonePlaceholder', 'email': 'emailPlaceholder'};
            Object.keys(formInputs).forEach(inputName => {
                const inputEl = document.querySelector(`input[name="${inputName}"]`);
                if(inputEl) inputEl.placeholder = translations[lang][formInputs[inputName]];
            });

            if (state.driverType) calculateResult();
        }

        function showView(viewId) {
            document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
            document.getElementById(viewId).classList.remove('hidden');

            const backMap = {
                'view-question2': 'view-question1', 'view-result': 'view-question2', 'view-apply': 'view-result', 'view-calculation': 'view-result'
            };
            backArrow.classList.toggle('hidden', !backMap[viewId]);
            if (backMap[viewId]) backArrow.onclick = () => showView(backMap[viewId]);

            const progressConfig = {
                'view-question1': { step: 1, text: 'Driver Type', width: '33%' },
                'view-question2': { step: 2, text: 'Weekly Miles', width: '66%' },
                'view-result': { step: 3, text: 'Your Results', width: '100%' }
            };
            const config = progressConfig[viewId];
            document.getElementById('progress-container').style.visibility = config ? 'visible' : 'hidden';
            if (config) {
                document.getElementById('progress-bar').style.width = config.width;
                const T = translations[state.lang] || translations.en;
                document.getElementById('progress-text').innerHTML = T.progressText.replace('{step}', config.step).replace('{page}', config.text);
            }
        }

        function selectDriverType(type) {
            state.driverType = type;
            showView('view-question2');
        }

        function submitMiles() {
            const miles = parseInt(document.getElementById('miles-input').value, 10);
            if (isNaN(miles) || miles <= 0) return alert('Please enter a valid number of miles.');
            state.miles = miles;
            calculateResult();
            showView('view-result');
            confetti({ particleCount: 150, spread: 90, origin: { y: 0.6 } });
        }

        function calculateResult() {
            let result = 0;
            switch(state.driverType) {
                case 'lease': result = (state.miles * 2.15) * 0.85 - 900 - (0.12 * state.miles) - 375 - (state.miles * 0.45) - 75 - 37 - 250; break;
                case 'company': result = state.miles * 0.65; break;
                case 'owner': result = (state.miles * 2.15) * 0.88 - 375 - (state.miles * 0.45) - 75 - 37 - 250; break;
            }
            state.takeHomePay = result > 0 ? result : 0;
            document.getElementById('result-amount').textContent = state.takeHomePay.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
            
            const msgEl = document.getElementById('result-message');
            const T = translations[state.lang] || translations.en;
            if (result > 2800) msgEl.innerHTML = T.resultMsgHigh;
            else if (result >= 1800) msgEl.innerHTML = T.resultMsgMid;
            else msgEl.innerHTML = T.resultMsgLow;
        }

        function getCalculationText() {
             const T = translations[state.lang] || translations.en;
             // This is a simplified version. A more detailed one could be built here.
             return `<div class="p-3 bg-gray-50 rounded-lg border">
                <p><strong>Driver Type:</strong> ${state.driverType}</p>
                <p><strong>Weekly Miles:</strong> ${state.miles}</p>
                <p class="mt-2 border-t pt-2">Based on our current rates, your estimated take-home pay is calculated by taking the gross income and subtracting estimated expenses like fuel, insurance, and service charges.</p>
                <p class="font-bold text-lg mt-2">${T.resultTitle}: ${state.takeHomePay.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}</p>
             </div>`;
        }

        function showCalculation() {
            document.getElementById('calculation-details').innerHTML = getCalculationText();
            showView('view-calculation');
        }
        
        async function shareResult() {
            const url = new URL(window.location.href);
            url.search = `?type=${state.driverType}&miles=${state.miles}&result=${state.takeHomePay.toFixed(2)}&lang=${state.lang}`;
            const shareData = {
                title: 'My Potential Earnings at Ray Star LLC',
                text: `Check out my potential weekly take-home pay of ${state.takeHomePay.toLocaleString('en-US', { style: 'currency', currency: 'USD' })} with Ray Star LLC!`,
                url: url.toString()
            };
            if (navigator.share) {
                try { await navigator.share(shareData); } catch (err) { console.error("Share failed:", err); }
            } else {
                navigator.clipboard.writeText(url.toString());
                alert('A shareable link has been copied to your clipboard!');
            }
        }

        function restart() {
            state.driverType = null;
            state.miles = 0;
            document.getElementById('miles-input').value = '';
            showView('view-question1');
        }

        function trackEvent(action, eventValue) {
            const formData = new FormData();
            formData.append('action', action);
            formData.append('event', eventValue);
            fetch(scriptURL, { method: 'POST', body: formData, mode: 'no-cors' }).catch(console.error);
        }
        
        function trackClickEvent(eventName) { trackEvent('clickEvent', eventName); }
        
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const type = urlParams.get('type'), miles = urlParams.get('miles'), result = urlParams.get('result'), lang = urlParams.get('lang');
            
            setLanguage(lang || 'en');

            if (type && miles && result) {
                state.driverType = type;
                state.miles = parseInt(miles, 10);
                state.takeHomePay = parseFloat(result);
                document.getElementById('result-amount').textContent = state.takeHomePay.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                calculateResult();
                showView('view-result');
            } else {
                showView('view-question1');
                trackEvent('pageView', 'Page Loaded');
            }
            
            languageToggleBtn.addEventListener('click', (e) => { e.stopPropagation(); languageDropdown.classList.toggle('hidden'); });
            document.addEventListener('click', () => languageDropdown.classList.add('hidden'));

            const form = document.getElementById('application-form');
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                const submitBtn = document.getElementById('submit-form-button');
                const originalText = submitBtn.innerHTML;
                submitBtn.disabled = true;
                submitBtn.innerHTML = 'Submitting...';

                const formData = new FormData(form);
                formData.append('action', 'formSubmit');
                formData.append('driverType', state.driverType);
                formData.append('miles', state.miles);
                formData.append('potentialPay', state.takeHomePay.toFixed(2));

                fetch(scriptURL, { method: 'POST', body: formData, mode: 'no-cors' })
                    .then(() => showView('view-thanks'))
                    .catch(() => showView('view-thanks')) // Show thanks even on CORS error
                    .finally(() => {
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = originalText;
                        form.reset();
                    });
            });
        });
    </script>
</body>
</html>

